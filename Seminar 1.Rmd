---
title: "Seminar 1"
author: "Lydwin Wagenaar"
date: "`r Sys.Date()`"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Seminar 2023-11-01

The standard error equation is 
SE = sqrt(var/n)
```{r}
x <- rnorm(n=100, mean=5,sd=1)
mean(x)
sd(x)
hist(x,las=1,main = "")

set.seed(1)
x <- rnorm(50,10,2)
se_x <- sqrt(var(x)/length(x))

out = NULL
outcv = NULL
for(i in 1:1000){
sample = sample(x, replace=TRUE)
out[i] = mean(sample)
outcv[i] = sqrt(sd(sample)/mean(sample))
}

hist(out,las=1,main="")
sd(out)
quantile(out,c(0.025,0.975))
#or
mean(x) - 1.96*se_x
mean(x) + 1.96*se_x
```
Exercise: Derive a 95% confidence interval for the CV of x.
sample: you will take a sample each time but replace is true so you get a bit different values
```{r}
x <- rnorm(50,10,2)
cv <- sqrt(sd(x)/mean(x))
cv_out <- sqrt(sd(out)/mean(out))


outcv = NULL
for(i in 1:1000){
sample = sample(x, replace=TRUE)
outcv[i] = sd(sample)/mean(sample)
}

quantile(outcv,c(0.025,0.975))

```

Optional exercise: The proportional properties of the natural log
Use simulated data to show the close relationship between the SD of log-transformed data and the CV on
arithmetic scale. You may need e.g. the rnorm function and a for-loop to achieve this. One strategy would
be to start with comparing the two values for a single case, then build a matrix to hold the paired values,
and finally use a for-loop to populate the matrix. See Appendix 1 for help to get started with programming.
The following figure illustrates the kind of pattern we expect.
Before starting to work on exercises in R, read the Appendix on reproducibility, and think about whether
you would like to create a GitHub account for all your materials from this course

```{r}

sdvals <- runif(200,1,5)
out <- matrix(NA,200,2)
for(i in 1:200){
y <- rnorm(n=200, mean=30,sd=sdvals[i])
out[i,1] <- sd(log(y))
out[i,2] <- sd(y)/mean(y)
}

library(ggplot2)
out1<-data.frame(out)
colnames(out1) <- c("logsd","CV")
ggplot(out1,mapping = aes(x = CV, y = logsd)) +
  geom_point() +
  geom_abline()
```



